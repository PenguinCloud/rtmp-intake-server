---
- name: Install Git
  apt:
    name: git
    force_apt_get: yes
    update_cache: yes

- name: Install Sudo
  apt:
    name: sudo
    force_apt_get: yes
    update_cache: yes

- name: Download OSSRS files
  git:
    repo: "https://github.com/ossrs/srs.git"
    version: develop
    dest: "/opt/manager/bins/srs"

- name: Build OSSRS
  shell:
    chdir: "/opt/manager/bins/srs/trunk"
    cmd: "sudo ./configure && make"

- name: Configure
  shell:
    chdir: "opt/manager/bins/srs/trunk"
    cmd: "./objs/srs -c conf/srs.conf"